# Trade Plan Simulation Training Guide

## 📊 개요

**Trade Plan Simulation Training**은 Decision Stream의 핵심 교육 모듈로, 실제 자금을 투입하기 전에 안전한 환경에서 중기 스윙 트레이딩 매매 계획을 수립하고 검증할 수 있는 시뮬레이션 도구입니다.

### 🎯 목적

- **안전한 학습**: 실제 매매 없이 매매 계획 수립 연습
- **리스크 관리 훈련**: 손절가, 목표가, 포지션 사이징 실전 적용
- **7요소 체크리스트 숙달**: 중기 스윙 투자 프레임워크 내재화
- **통계 추적**: 시뮬레이션 성과 분석 및 개선 포인트 발견

---

## 🚀 빠른 시작

### 1. 파일 열기

```bash
# 브라우저에서 직접 열기
open trade_plan_simulation.html

# 또는 로컬 서버로 실행 (권장)
python -m http.server 8000
# 브라우저에서 http://localhost:8000/trade_plan_simulation.html 접속
```

### 2. 매매 계획 수립 흐름

```
1️⃣ 시장 선택 (한국/미국)
   ↓
2️⃣ 섹터 및 종목 선택
   ↓
3️⃣ 투자 조건 설정 (기간, 리스크 성향, 투자 금액)
   ↓
4️⃣ 매매 계획 생성 버튼 클릭
   ↓
5️⃣ 결과 확인 (진입가, 손절가, 목표가, 포지션 크기)
   ↓
6️⃣ 7요소 체크리스트 검토
   ↓
7️⃣ 시뮬레이션 기록 저장 및 통계 누적
```

---

## 📋 7요소 체크리스트 설명

중기 스윙 투자 프레임워크의 핵심 평가 기준입니다. 총점 70점 이상일 때 진입을 고려합니다.

### 1. 수급 신호 (0-25점)

**평가 항목:**
- 외국인 누적 매수일수 및 규모
- 기관 누적 매수일수 및 규모
- 거래대금 추세 (지속적 증가 여부)

**PASS 기준:**
- 외국인 또는 기관이 최근 5일 이상 순매수
- 거래대금이 평균 대비 1.5배 이상 지속

**점수 배점:**
- 20-25점: 외국인·기관 동시 매수, 거래대금 급증
- 15-20점: 외국인 또는 기관 단독 매수
- 10-15점: 수급 신호 약함
- 0-10점: 수급 부정적

---

### 2. 정책/테마 (0-30점)

**평가 항목:**
- 뉴스 확정성 (루머 vs 확정 발표)
- 뉴스 지속성 (1회성 vs 구조적 변화)
- 실적 연결성 (단순 테마 vs 실제 매출·이익 증가)

**PASS 기준:**
- 정부 정책 확정 또는 대형 프로젝트 수주
- 최소 6개월 이상 지속 가능한 테마
- 실적 개선으로 이어질 가능성 높음

**점수 배점:**
- 25-30점: 확정 + 지속 + 실적연결 모두 충족
- 18-25점: 확정 + 지속 충족
- 10-18점: 확정 단독 또는 지속성 있는 테마
- 0-10점: 루머성 또는 1회성 테마

---

### 3. 시장 사이클 (0-10점)

**평가 항목:**
- 코스피/S&P500 지수 추세 (MA20 기준)
- 시장 변동성 (VIX, 역사적 변동성)
- Market Regime 상태 (RISK_ON / RISK_OFF)

**PASS 기준:**
- 지수가 MA20 위에서 상승 추세
- 변동성이 평균 수준 (과도한 변동 없음)
- Market Regime이 RISK_ON

**점수 배점:**
- 8-10점: 상승 추세 + 낮은 변동성
- 6-8점: 횡보 또는 변동성 증가
- 0-6점: 하락 추세 또는 고변동성

---

### 4. 기업 질 (0-10점)

**평가 항목:**
- 부채비율 (재무 안정성)
- 영업이익률 (수익성)
- 최근 3년 실적 추이 (성장성)

**PASS 기준:**
- 부채비율 < 100% (제조업 기준)
- 영업이익률 > 5%
- 최근 3년 매출·이익 성장세

**점수 배점:**
- 8-10점: 우량 기업 (부채 낮음, 수익성 높음)
- 6-8점: 평균적 재무 구조
- 0-6점: 재무 리스크 있음

---

### 5. 서사 (Narrative) (0-8점)

**평가 항목:**
- 산업 성장 스토리 (미래 전망)
- 기업의 경쟁력 (시장 점유율, 기술력)
- 투자자 관심도 (검색량, 리포트 발행 빈도)

**PASS 기준:**
- 향후 3-5년 산업 성장 예상
- 업계 상위 3위 이내 기업
- 증권사 리포트 다수 발행

**점수 배점:**
- 6-8점: 강력한 성장 스토리 + 업계 리더
- 4-6점: 산업 성장 스토리 존재
- 0-4점: 약한 서사 또는 성숙 산업

---

### 6. 하방 리스크 (0-10점)

**평가 항목:**
- 과열 신호 (단기 급등 여부)
- 개인 투자자 과열 (개인 비중 급증)
- 기술적 지지선 강도 (MA20, MA60 지지)

**PASS 기준:**
- 최근 10일 상승률 < 30%
- 개인 순매수 비중 < 60%
- MA20 위에서 안정적 지지

**점수 배점:**
- 8-10점: 과열 신호 없음, 안정적
- 5-8점: 일부 과열 징후
- 0-5점: 과열 구간, 조정 필요

---

### 7. 시간 적합성 (0-7점)

**평가 항목:**
- 조정 후 진입 타이밍 (눌림목 확인)
- 거래량 증가 추세 (매수세 유입)
- 기술적 진입 신호 (돌파, 지지 확인 등)

**PASS 기준:**
- MA20 터치 후 반등 시작
- 조정 구간에서 거래량 감소 후 재증가
- 지지선 확인 완료

**점수 배점:**
- 5-7점: 최적의 진입 타이밍
- 3-5점: 진입 가능하나 조정 더 필요
- 0-3점: 진입 타이밍 부적절

---

## 💰 포지션 사이징 및 리스크 관리

### 리스크 성향별 파라미터

| 리스크 성향 | 손절률 | 1차 목표 | 2차 목표 | 포지션 비중 |
|------------|--------|----------|----------|-------------|
| 보수적     | -8%    | +15%     | +25%     | 20%         |
| 중립       | -10%   | +20%     | +35%     | 25%         |
| 공격적     | -12%   | +25%     | +45%     | 30%         |

### 포지션 관리 원칙

#### 1. 진입 전략
- **1차 진입**: 현재가 대비 2% 낮은 가격에 지정가 주문
- **2차 진입**: MA20 터치 시 추가 매수 (총 포지션 30% 이내)

#### 2. 손절 전략
- **고정 손절**: 진입가 기준 -8% ~ -12%
- **추세 손절**: 20일선 종가 이탈 시 익일 장 초반 정리
- **예외**: 어떤 경우에도 -15% 이상 손실은 금지

#### 3. 익절 전략
- **1차 익절 (50%)**: +15% ~ +25% 도달 시 절반 매도
- **2차 익절 (30%)**: +25% ~ +45% 도달 시 30% 매도
- **잔량 (20%)**: 20일선 이탈 시까지 보유 (트레일링)

#### 4. 포지션 크기 제한
- **단일 종목**: 최대 30% (공격적 성향 기준)
- **동시 보유**: 최대 3종목
- **현금 비중**: 최소 30% 상시 유지

---

## 📈 시뮬레이션 기록 분석

### 추적 지표

1. **승률 (Win Rate)**
   - 익절 종료 / 전체 시뮬레이션
   - 목표: 50% 이상

2. **평균 수익률 (Average Return)**
   - 총 수익률 / 전체 시뮬레이션
   - 목표: +5% 이상

3. **손익비 (Profit Ratio)**
   - 평균 익절 수익 / 평균 손절 손실
   - 목표: 2:1 이상

4. **최대 연속 손실 (Max Consecutive Losses)**
   - 연속 손절 횟수
   - 경고: 3회 이상 시 전략 재검토 필요

### 성과 개선 방법

#### 승률이 낮을 때 (<40%)
- ✅ 7요소 체크리스트 통과 기준 강화 (70점 → 75점)
- ✅ 시장 사이클 확인 강화 (RISK_OFF 시 진입 금지)
- ✅ 진입 타이밍 개선 (조정 후 진입 원칙 준수)

#### 평균 수익률이 낮을 때 (<3%)
- ✅ 익절 목표가 재조정 (너무 빨리 익절하는지 점검)
- ✅ 포지션 크기 확대 검토 (보수 → 중립)
- ✅ 고점수 종목 선택 강화 (75점 이상만 진입)

#### 손익비가 낮을 때 (<1.5:1)
- ✅ 손절 타이밍 점검 (손절이 너무 늦지 않은지)
- ✅ 익절 전략 개선 (2차 익절까지 보유)
- ✅ 종목 선택 기준 강화 (수급·정책 항목 점수 향상)

---

## 🎓 교육 시나리오

### 시나리오 1: 초보자 (첫 10회 시뮬레이션)

**목표**: 프레임워크 숙지 및 기본 절차 학습

1. 보수적 리스크로만 시뮬레이션 진행
2. 7요소 체크리스트 항목별 의미 이해
3. 손절가 엄수 연습
4. 시뮬레이션 기록 10건 누적

**성공 기준**:
- 10회 완료
- 체크리스트 항목 이해도 100%
- 손절가 미준수 0건

---

### 시나리오 2: 중급자 (11-30회 시뮬레이션)

**목표**: 리스크 관리 및 포지션 사이징 숙달

1. 중립 리스크 도입 (보수:중립 = 7:3)
2. 포지션 크기 실험 (20% vs 25%)
3. 익절 전략 비교 (1차만 vs 1차+2차)
4. 승률 50% 이상 달성

**성공 기준**:
- 승률 ≥ 50%
- 평균 수익률 ≥ +5%
- 손익비 ≥ 1.8:1

---

### 시나리오 3: 고급자 (31회 이상)

**목표**: 최적화 및 실전 준비

1. 공격적 리스크 도입 (조건: 총점 80점 이상)
2. 2차 진입 전략 실습
3. 트레일링 스톱 활용
4. 월간 목표 수익률 +10% 달성

**성공 기준**:
- 승률 ≥ 55%
- 평균 수익률 ≥ +8%
- 손익비 ≥ 2.2:1
- 최대 연속 손실 ≤ 2회

---

## 🔗 API 연동 (선택사항)

실제 백엔드 서버와 연동하려면 아래 API 엔드포인트를 활용하세요.

### 1. 매매 계획 생성

```http
POST http://127.0.0.1:8125/trade_plan/generate?key=ds-test-2026
Content-Type: application/json

{
  "market": "KR",
  "sector": "반도체",
  "ticker": "005930",
  "name": "삼성전자",
  "current_price": 75000,
  "period": "중기",
  "risk": "중립",
  "capital": 5000000
}
```

**응답 예시:**
```json
{
  "entry_price": 73500,
  "stop_loss": 66150,
  "target_1": 88200,
  "target_2": 99225,
  "quantity": 68,
  "position_size": 0.25,
  "actual_investment": 4998000,
  "max_loss": 499800,
  "expected_profit": 999600,
  "risk_reward_ratio": 2.0,
  "checklist": [...],
  "risk_warning": "✅ 체크리스트 통과!",
  "total_score": 78
}
```

### 2. 섹터별 종목 조회

```http
GET http://127.0.0.1:8125/trade_plan/stocks?sector=반도체&key=ds-test-2026
```

### 3. 시뮬레이션 통계 조회

```http
GET http://127.0.0.1:8125/trade_plan/stats?key=ds-test-2026
```

---

## 📝 실전 체크리스트

시뮬레이션에서 실전으로 전환하기 전 확인 사항:

- [ ] 최소 30회 이상 시뮬레이션 완료
- [ ] 승률 50% 이상 달성
- [ ] 손익비 2:1 이상 달성
- [ ] 최대 연속 손실 3회 이하
- [ ] 7요소 체크리스트 항목별 이해도 100%
- [ ] 손절가 엄수 기록 100%
- [ ] 감정 통제 능력 확인 (과매매 없음)
- [ ] 최소 3개월 시뮬레이션 기간 경과
- [ ] 포트폴리오 시뮬레이션 (다종목 동시 운용) 완료
- [ ] 실전 자금 < 전체 자산의 20%로 시작

---

## ⚠️ 주의사항

### 시뮬레이션의 한계

1. **슬리피지 미반영**: 실제 체결가는 계산된 진입가와 다를 수 있음
2. **감정 변수 제외**: 실전에서는 공포·탐욕이 판단에 영향
3. **유동성 미고려**: 대형주가 아닌 경우 원하는 가격에 매매 어려움
4. **거래비용 단순화**: 수수료, 세금 등 실제 비용 발생

### 실전 전환 시 주의사항

1. **시작은 작게**: 시뮬레이션 수익률의 50%만 기대
2. **손절 엄수**: 실전에서는 더 엄격하게 적용
3. **기록 유지**: 모든 매매의 이유와 결과 기록
4. **정기 점검**: 월 1회 성과 분석 및 전략 조정

---

## 🆘 FAQ

### Q1. 시뮬레이션 기록이 사라졌어요!

A: 브라우저의 `localStorage`에 저장되므로, 같은 브라우저의 같은 도메인에서 접속해야 합니다. 다른 브라우저나 시크릿 모드에서는 기록이 유지되지 않습니다.

### Q2. 손절가를 -8%로 설정했는데 손실이 더 커질 수 있나요?

A: 네. 갭 하락(전일 대비 큰 폭 하락 출발) 시 손절 주문이 더 낮은 가격에 체결될 수 있습니다. 이를 방지하려면 유동성 높은 대형주 위주로 매매하세요.

### Q3. 7요소 체크리스트 점수가 자동으로 계산되나요?

A: 현재 버전은 목업 데이터로 작동하므로, 실제 점수는 백엔드 API와 연동해야 정확합니다. 시뮬레이션 모드에서는 학습 목적으로 임의 점수가 생성됩니다.

### Q4. 미국 주식도 지원하나요?

A: UI는 한국/미국 선택을 지원하나, 종목 데이터베이스는 한국 주식만 제공됩니다. 미국 주식 데이터를 추가하려면 `STOCK_DATABASE` 객체에 미국 종목을 추가하세요.

### Q5. 실제 매매는 어떻게 하나요?

A: 이 도구는 **시뮬레이션 전용**입니다. 실제 매매는 증권사 HTS/MTS를 통해 수동으로 진행해야 합니다.

---

## 📚 추가 학습 자료

- **Decision Stream Dashboard**: 실시간 시장 분석 및 종목 발굴 (index.html)
- **HTS 데이터 변환 가이드**: QUICKSTART.md 참조
- **중기 스윙 프레임워크**: README.md 참조

---

## 📞 지원

문제가 발생하거나 기능 개선 제안이 있다면 프로젝트 리포지토리에 이슈를 등록해 주세요.

**행운을 빕니다! 🚀📈**
