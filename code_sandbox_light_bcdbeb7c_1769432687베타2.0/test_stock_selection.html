<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì¢…ëª© ì„ íƒ í…ŒìŠ¤íŠ¸</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 40px;
            background: #1a1a1a;
            color: #fff;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
            background: #2a2a2a;
            padding: 30px;
            border-radius: 10px;
        }
        h1 {
            color: #667eea;
        }
        select, input {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            border: 1px solid #444;
            background: #333;
            color: #fff;
            font-size: 16px;
        }
        button {
            width: 100%;
            padding: 12px;
            margin: 10px 0;
            border-radius: 5px;
            border: none;
            background: #667eea;
            color: #fff;
            font-size: 16px;
            cursor: pointer;
        }
        button:hover {
            background: #5568d3;
        }
        .log {
            margin-top: 20px;
            padding: 15px;
            background: #1a1a1a;
            border-radius: 5px;
            font-family: monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
        }
        .log-item {
            margin: 5px 0;
            padding: 5px;
            border-left: 3px solid #667eea;
            padding-left: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§ª ì¢…ëª© ì„ íƒ í…ŒìŠ¤íŠ¸</h1>
        
        <label>ì„¹í„° ì„ íƒ:</label>
        <select id="sector" onchange="handleSectorChange()">
            <option value="">-- ì„¹í„° ì„ íƒ --</option>
            <option value="ë°©ì‚°">ë°©ì‚°</option>
            <option value="ë°˜ë„ì²´">ë°˜ë„ì²´</option>
        </select>
        
        <label>ì¢…ëª© ì„ íƒ:</label>
        <select id="stock" onchange="handleStockChange()">
            <option value="">-- ë¨¼ì € ì„¹í„°ë¥¼ ì„ íƒí•˜ì„¸ìš” --</option>
        </select>
        
        <label>í˜„ì¬ ì£¼ê°€:</label>
        <input type="number" id="current-price" placeholder="ìë™ ì…ë ¥ë©ë‹ˆë‹¤" readonly>
        
        <button onclick="openChart()">ğŸ“Š ì°¨íŠ¸ ë¶„ì„ ì—´ê¸°</button>
        <button onclick="clearLog()">ğŸ—‘ï¸ ë¡œê·¸ ì§€ìš°ê¸°</button>
        
        <div class="log" id="log"></div>
    </div>

    <script>
        const STOCK_DATABASE = {
            'ë°©ì‚°': [
                { ticker: 'LMT', name: 'Lockheed Martin', price: 445.50 },
                { ticker: '012450', name: 'í•œí™”ì—ì–´ë¡œìŠ¤í˜ì´ìŠ¤', price: 185000 },
                { ticker: '079550', name: 'LIGë„¥ìŠ¤ì›', price: 95000 }
            ],
            'ë°˜ë„ì²´': [
                { ticker: '005930', name: 'ì‚¼ì„±ì „ì', price: 75000 },
                { ticker: '000660', name: 'SKí•˜ì´ë‹‰ìŠ¤', price: 142000 }
            ]
        };

        function log(message, color = '#667eea') {
            const logDiv = document.getElementById('log');
            const item = document.createElement('div');
            item.className = 'log-item';
            item.style.borderLeftColor = color;
            item.textContent = new Date().toLocaleTimeString() + ' - ' + message;
            logDiv.insertBefore(item, logDiv.firstChild);
        }

        function clearLog() {
            document.getElementById('log').innerHTML = '';
        }

        function handleSectorChange() {
            const sector = document.getElementById('sector').value;
            const stockSelect = document.getElementById('stock');
            const priceInput = document.getElementById('current-price');
            
            log('ì„¹í„° ì„ íƒ: ' + sector, '#48bb78');
            
            stockSelect.innerHTML = '<option value="">-- ì¢…ëª© ì„ íƒ --</option>';
            priceInput.value = '';
            
            if (sector && STOCK_DATABASE[sector]) {
                STOCK_DATABASE[sector].forEach(stock => {
                    const option = document.createElement('option');
                    option.value = stock.ticker;
                    option.textContent = `${stock.name} (${stock.ticker})`;
                    option.dataset.price = stock.price;
                    option.dataset.name = stock.name;
                    stockSelect.appendChild(option);
                });
                log(`${STOCK_DATABASE[sector].length}ê°œ ì¢…ëª© ë¡œë“œë¨`, '#48bb78');
            }
        }

        function handleStockChange() {
            const stockSelect = document.getElementById('stock');
            const selectedOption = stockSelect.options[stockSelect.selectedIndex];
            const priceInput = document.getElementById('current-price');
            
            log('handleStockChange í˜¸ì¶œë¨', '#667eea');
            
            if (!stockSelect.value) {
                log('ì¢…ëª© ì„ íƒ ì•ˆë¨', '#fc8181');
                priceInput.value = '';
                return;
            }
            
            log('ì„ íƒëœ ì¢…ëª©: ' + stockSelect.value, '#48bb78');
            log('Dataset price: ' + selectedOption?.dataset?.price, '#667eea');
            
            if (selectedOption && selectedOption.dataset && selectedOption.dataset.price) {
                const price = selectedOption.dataset.price;
                priceInput.value = price;
                log('âœ… ì£¼ê°€ ìë™ ì…ë ¥: ' + price, '#48bb78');
            } else {
                log('âŒ Datasetì— ê°€ê²© ì •ë³´ ì—†ìŒ', '#fc8181');
                priceInput.value = '';
            }
        }

        function openChart() {
            const ticker = document.getElementById('stock').value;
            
            if (!ticker) {
                alert('ë¨¼ì € ì¢…ëª©ì„ ì„ íƒí•˜ì„¸ìš”.');
                log('âŒ ì¢…ëª© ë¯¸ì„ íƒ', '#fc8181');
                return;
            }
            
            const chartUrl = `chart_analysis.html?ticker=${ticker}`;
            log('ì°¨íŠ¸ URL: ' + chartUrl, '#667eea');
            
            try {
                const newWindow = window.open(chartUrl, '_blank');
                if (newWindow) {
                    log('âœ… ì°¨íŠ¸ ì°½ ì—´ë¦¼', '#48bb78');
                } else {
                    log('âŒ íŒì—… ì°¨ë‹¨ë¨', '#fc8181');
                    alert('íŒì—…ì´ ì°¨ë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤. ë¸Œë¼ìš°ì € ì„¤ì •ì„ í™•ì¸í•˜ì„¸ìš”.');
                }
            } catch (error) {
                log('âŒ ì—ëŸ¬: ' + error.message, '#fc8181');
            }
        }
    </script>
</body>
</html>
