# 데이터 비용 분석 - Decision Stream

## 💰 월 9,900원으로 운영 가능한가?

### ✅ 결론: **가능합니다!**

**총 데이터 비용: ₩0 (무료 데이터만 사용)**  
**서버 비용: ₩6,500/월**  
**구독료: ₩9,900/월**  
**순이익: ₩3,400/월**

---

## 📊 데이터 소스별 비용 분석

### 1️⃣ 한국 시장 (무료 100%)

#### KRX 투자자별 매매동향 (무료)
```
출처: KRX 정보데이터시스템
URL: http://data.krx.co.kr
비용: ₩0

제공 데이터:
- 외국인 순매수/순매도
- 기관 순매수/순매도
- 개인 순매수/순매도
- 일자별/종목별 데이터

제약:
- 20분 지연 (충분함, 스윙 투자용)
- API 호출 제한 (캐싱으로 해결)
- 일별 데이터만 (분봉 없음, 괜찮음)

우회 전략:
- Redis 캐싱 (5분 갱신)
- 장 시작 후 1회 배치 수집
- 종목당 1일 1회 호출
```

#### OpenDART API (무료)
```
출처: 금융감독원 전자공시시스템
URL: https://opendart.fss.or.kr
비용: ₩0
API 키: 무료 발급

제공 데이터:
- 공시 (수주/실적/배당/합병)
- 재무제표 (매출/영업이익/부채비율)
- 대규모 내부거래
- 최대주주 변경

제약:
- 일 10,000건 호출 제한
  → 해결: 전체 2,000개 종목 × 5개 API = 10,000건 (딱 맞음!)
- XML 형식 (파싱 필요)

활용:
- 섹터별 실적 집계
- 수주/계약 뉴스 자동 감지
- 재무 건전성 점수 계산
```

#### 네이버 금융 뉴스 (무료, 크롤링)
```
출처: 네이버 금융 종목별 뉴스
URL: https://finance.naver.com/item/news.nhn?code=005930
비용: ₩0

제공 데이터:
- 종목별 뉴스 (연합뉴스, 조선경제 등)
- 뉴스 제목/내용/시간

제약:
- 크롤링 규칙 준수 (robots.txt)
- 과도한 호출 금지 (1초당 1건)

우회 전략:
- RSS 피드 활용
- 30분마다 배치 수집
- 키워드 필터링 (정책, 수주, 실적)
```

**한국 총 비용: ₩0**

---

### 2️⃣ 미국 시장 (무료 + 제한적)

#### Yahoo Finance API (무료)
```
출처: Yahoo Finance (yfinance Python)
비용: ₩0

제공 데이터:
- EOD 가격 (종가/고가/저가/거래량)
- 이동평균, 변동성
- 시가총액, PER, PBR

제약:
- 2,000 calls/hour (충분함)
- 15분 지연 (스윙 투자엔 괜찮음)
- 분봉 없음 (EOD만)

활용:
- 섹터 ETF 추적 (XLK, XLF, XLE...)
- S&P 500 지수
- VIX 변동성
```

#### Alpha Vantage (Free Tier)
```
출처: Alpha Vantage
URL: https://www.alphavantage.co
비용: ₩0 (Free Plan)

제공 데이터:
- 재무제표 (분기별/연도별)
- PER, PBR, ROE
- Earnings (실적 발표일)

제약:
- 5 API calls/minute
- 500 calls/day

우회 전략:
- 상위 100개 종목만 추적
- 재무제표는 1주 1회 갱신
- 실적 시즌에만 집중 호출
```

#### FRED API (무료)
```
출처: Federal Reserve Economic Data
URL: https://fred.stlouisfed.org/docs/api
비용: ₩0

제공 데이터:
- 10년물 국채 수익률
- 실업률
- GDP 성장률
- VIX 지수

제약:
- 없음 (무제한)

활용:
- Market Regime 판단
- 금리/환율 추세
```

**미국 총 비용: ₩0**

---

### 3️⃣ 글로벌 매크로 (무료)

#### Investing.com RSS (무료, 크롤링)
```
출처: Investing.com Economic Calendar
비용: ₩0

제공 데이터:
- 경제 지표 발표 일정 (금리 결정, 고용 지표)
- 주요 이벤트

활용:
- Market Regime 보조 지표
```

**글로벌 총 비용: ₩0**

---

## 🎯 데이터 수집 전략

### 캐싱 정책 (비용 절감의 핵심)
```python
CACHE_POLICY = {
    # 한국
    "kr_price": "5분",           # KRX 가격
    "kr_flow": "1시간",          # 투자자별 매매
    "kr_disclosure": "30분",     # DART 공시
    "kr_news": "15분",           # 네이버 뉴스
    
    # 미국
    "us_price": "15분",          # Yahoo Finance
    "us_fundamental": "1일",     # Alpha Vantage
    "us_macro": "1일",           # FRED
    
    # 글로벌
    "economic_calendar": "1일"
}
```

### 배치 수집 스케줄
```python
BATCH_SCHEDULE = {
    # 장 시작 전 (08:30)
    "08:30": [
        "collect_kr_market_data",     # KRX 전일 데이터
        "collect_us_overnight"        # 미국 전날 종가
    ],
    
    # 장 중 (10:00, 14:00)
    "10:00": ["collect_kr_flow"],     # 투자자별 매매
    "14:00": ["collect_kr_flow"],
    
    # 장 마감 후 (15:40)
    "15:40": [
        "collect_kr_eod",             # 한국 종가
        "process_daily_scores"        # 점수 계산
    ],
    
    # 미국 장 중 (22:00)
    "22:00": ["collect_us_price"],
    
    # 미국 장 마감 후 (06:00)
    "06:00": [
        "collect_us_eod",
        "process_us_scores"
    ]
}
```

### API 호출 최적화
```python
# KRX: 일 2,000개 종목
# → 섹터별 상위 10개만 = 200개 종목
# → 호출 1회당 10개 종목 = 20회 호출
# → 충분히 제한 내

# OpenDART: 일 10,000건
# → 200개 종목 × 5개 API = 1,000건
# → 여유 9배

# Yahoo Finance: 시간당 2,000건
# → 100개 미국 종목 = 100건
# → 여유 20배

# Alpha Vantage: 일 500건
# → 100개 종목 ÷ 7일 = 일 15건
# → 충분
```

---

## 💸 서버 비용

### Railway Hobby Plan (₩6,500/월)
```
플랜: Hobby
비용: $5/월 ≈ ₩6,500
스펙:
- CPU: 512MB RAM
- vCPU: 0.5
- 실행 시간: 500 hours/month

충분성 판단:
✅ FastAPI 서버 (경량)
✅ Redis 캐싱 (메모리 효율)
✅ 배치 작업 (CPU 부하 낮음)
✅ 동시 접속 50명 (베타 충분)
```

### Redis Cloud (무료)
```
플랜: Free
비용: ₩0
스펙:
- 메모리: 30MB
- 동시 연결: 30
- 대역폭: 무제한

충분성 판단:
✅ 캐시 키 200개 × 100KB = 20MB
✅ 동시 접속 30명 (베타 충분)
```

**서버 총 비용: ₩6,500/월**

---

## 📊 손익 분석

### 구독 모델
```
기본 플랜: ₩9,900/월
- Market Regime
- Sector Scout (Top 10)
- Stock Funnel (Leader/Follower/No-Go)
- Trade Plan Builder
- Devil's Advocate

비용:
- 데이터: ₩0
- 서버: ₩6,500
- 순이익: ₩3,400/월

손익분기점:
- 유료 회원 1명 = ₩3,400 이익
- 유료 회원 10명 = ₩34,000 이익
- 유료 회원 100명 = ₩340,000 이익
```

### 확장 시나리오
```
회원 100명:
- 매출: ₩990,000/월
- 비용: ₩6,500 (서버)
- 순이익: ₩983,500/월

회원 500명:
- 매출: ₩4,950,000/월
- 비용: ₩40,000 (서버 업그레이드)
- 순이익: ₩4,910,000/월

회원 1,000명:
- 매출: ₩9,900,000/월
- 비용: ₩100,000 (서버 + 실시간 데이터)
- 순이익: ₩9,800,000/월
```

---

## 🚀 Premium 업그레이드 (₩19,900/월)

### 추가 데이터 비용
```
실시간 미국 데이터:
- Polygon.io Starter: $29/월 ≈ ₩38,000
- 15분 지연 → 실시간
- WebSocket 연결
- 동시 접속 5개

호가 데이터:
- Finnhub Free: ₩0
- 최고가/최저가 30분 지연

Alert 시스템:
- Twilio Free: 무료 (월 200건)
- Email: 무료 (SendGrid Free)
```

### Premium 손익
```
가격: ₩19,900/월
추가 비용: ₩38,000 ÷ Premium 회원 수

손익분기점:
- Premium 10명: ₩199,000 - ₩38,000 = ₩161,000 이익
- Premium 50명: ₩995,000 - ₩38,000 = ₩957,000 이익
```

---

## 🎯 Elite 플랜 (₩29,900/월)

### 추가 기능 비용
```
포트폴리오 백테스트:
- 자체 알고리즘 (비용 없음)
- 역사 데이터 캐싱 (스토리지만)

증권사 API:
- 한국투자증권 OpenAPI: 무료
- 키움 Open API+: 무료

비용: ₩0 (개발 비용만)
```

---

## 📈 결론

### ✅ 월 9,900원 모델은 현실적입니다

**이유:**
1. **무료 데이터가 충분하다**
   - KRX (투자자별 매매, 가격)
   - OpenDART (공시, 실적)
   - Yahoo Finance (미국 EOD)
   - FRED (매크로)

2. **스윙 투자에는 지연 데이터가 충분하다**
   - 20분 지연 ≈ 실시간 (1~3개월 보유)
   - EOD 종가로 충분
   - 분봉 불필요

3. **캐싱으로 API 호출 최소화**
   - Redis 30MB로 충분
   - 배치 수집으로 효율 극대화

4. **서버 비용이 저렴하다**
   - Railway: ₩6,500/월
   - Redis: 무료
   - 총: ₩6,500/월

5. **차별화는 데이터가 아니라 AI + UX**
   - 5개 Agent
   - 설명 가능한 점수
   - Devil's Advocate
   - Trade Plan 자동 생성

---

## ⚠️ 리스크 관리

### 데이터 소스 장애 대응
```python
ERROR_HANDLING = {
    "krx_down": "전일 캐시 사용 + 경고 표시",
    "dart_timeout": "뉴스로 대체",
    "yahoo_rate_limit": "캐시 반환",
    "all_down": "시스템 점검 공지"
}
```

### API 제한 대응
```python
RATE_LIMIT_PROTECTION = {
    "krx": "배치 수집 (1일 1회)",
    "dart": "종목 200개로 제한",
    "yahoo": "캐싱 5분",
    "alpha_vantage": "주말 대량 수집"
}
```

---

## 🎯 핵심 메시지

> **"월 9,900원으로 충분히 운영 가능하다!"**
>
> 왜냐하면:
> - 데이터 비용: ₩0 (무료 소스만)
> - 서버 비용: ₩6,500 (경량 시스템)
> - 차별화: AI + 설명 가능성 (데이터 양이 아님)
> - 대상: 스윙 투자자 (실시간 불필요)

**Let's go! 🚀**
